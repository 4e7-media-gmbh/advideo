<html>

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-23676405-1"></script>
  <script src="https://cdn.jsdelivr.net/npm/google-analytics-js@0.1.2/gajs.min.js"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-23676405-1');
  </script>


  <link href="https://vjs.zencdn.net/7.6.0/video-js.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-ads/6.6.4/videojs-contrib-ads.css"
    integrity="sha256-f+a2V2XwmdqEF6E7+VutpBwsGhbL8TSJMxhYbmYVLkU=" crossorigin="anonymous" />
  <link rel="stylesheet" href="../dist/videojs.ima.css" />
  <style>
    body {
      margin: 0px;
      padding: 0px;
    }

    video {
      width: 100vw;
      height: 100vh;
    }

    .vast-blocker {
      display: block;
      position: absolute;
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
    }

    .video-js {
      width: 100%;
      height: 0;
      padding-bottom: 52.28%;
    }

    .udcont {
      margin-bottom: 50px;
    }
  </style>

</head>

<body>

  <video controls id="myvideo" class="video-js">
    <source src="https://www.notorious-mag.com/sites/default/files/4morninghabits.mp4" type="video/mp4">
  </video>
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script src='https://notorious-mag.com/sites/all/libraries/vjs/video.js'></script>
  <script src="//imasdk.googleapis.com/js/sdkloader/ima3.js"></script>
  <script src="/vpaid.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-ads/6.6.4/videojs-contrib-ads.js"
    integrity="sha256-Vy2TyzNwiCLcPZwFweJ3MaIatSpvJpZkqSffp6dRLeo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-ads/6.6.4/videojs.ads.js"
    integrity="sha256-Vy2TyzNwiCLcPZwFweJ3MaIatSpvJpZkqSffp6dRLeo=" crossorigin="anonymous"></script>
  <script src="../dist/videojs.ima.js"></script>
  <script src="player.js"></script>
  <!--script src="/rollads.js"></script-->
  <!--script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-playLists/0.2.0/videojs-playlists.min.js" integrity="sha256-NKUlYyblJbPhZvgROcDiBE+0VumNzulTrF83HnPLFm8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/fw-videojs-playlist@4.0.4/dist/videojs-playlist.cjs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-playLists/0.2.0/videojs-playlists.min.js" integrity="sha256-NKUlYyblJbPhZvgROcDiBE+0VumNzulTrF83HnPLFm8=" crossorigin="anonymous"></script-->
  <!--script src="https://rawgit.com/atlance01/vrapp-ionic/master/www/js/lib/videojs-playlist.js"></script-->
  <script>
    var adv = ""
    var adc = ""
    var midplayed = false
    var time = ""

    function getad() {

      var myrnd = Math.floor(Math.random() * 10000000)
      fetch("https://ad1.adfarm1.adition.com/banner?sid=3123832&ts=" + myrnd + "&wpt=X&prf[consent]=optin")
        .then(function (resp) {
          return resp.text();
        })
        .then(function (data) {
          let praser = new DOMParser(),
            xmlDoc = praser.parseFromString(data, 'text/xml');
          adTagz = xmlDoc.getElementsByTagName("MediaFile")
          advideo = adTagz.item(0).innerHTML.replace("<![CDATA[", "").replace("]]>", "");
          adclick = xmlDoc.getElementsByTagName("ClickThrough");
          click = adclick.item(0).innerHTML.replace("<![CDATA[", "").replace("]]>", "")
          adv = advideo
        })
    }


    var player = videojs('myvideo', {
      muted: true,
      controls: true,
      autoplay: true,
    });

    var options = {
      id: 'myvideo',
    };

    function midtimer() {


      if (midplayed == false) {
        getad()
        midplayed = true
        var int = setInterval(function () {
          half = player.duration() / 2
          current = player.currentTime()
          console.log(player.currentTime())
          if (current >= half) {
            clearInterval(int);
            midplay = true
            player.ads.startLinearAdMode();
            player.src(adv);

          }
        }, 1000)
      }
    }
    player.ads()
    // request ads whenever there's new video content
    player.on('contentchanged', function () {
      // in a real plugin, you might fetch new ad inventory here
      player.trigger('adsready');
    });

    player.one('readyforpreroll', function () {
      player.ads.startLinearAdMode();
      // play your linear ad content
      // in this example, we use a static mp4
      getad()
      setTimeout(function () {
        src = adv
        console.log(adv)
        player.src(src);
      }, 500);


      // send event when ad is playing to remove loading spinner
      player.on('adplaying', function () {
        player.trigger('ads-ad-started');
      });

      // resume content when all your linear ads have finished
      player.on('adended', function () {
        player.ads.endLinearAdMode();
        console.log("nice")
        time = player.duration() / 2 * 10000;
        midtimer()
      });

    });
    player.one("readyforpostroll ", function(){
      player.ads.startLinearAdMode();
    })
    // in a real plugin, you might fetch ad inventory here
    player.trigger('adsready');
  </script>
</body>

</html>